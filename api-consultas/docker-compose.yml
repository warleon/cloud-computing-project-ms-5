services:
  api-consultas-datalake:
    build: .
    image: br4yangc/cloud-computing-project-ms-5:api-consultas
    container_name: api-consultas-datalake
    ports:
      - "${API_PORT:-8000}:8000"
    env_file:
      - .env
    environment:
      # AWS Configuration
      - AWS_DEFAULT_REGION=${AWS_DEFAULT_REGION:-us-east-1}
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
      - AWS_SESSION_TOKEN=${AWS_SESSION_TOKEN}
      # Athena Configuration
      - ATHENA_DATABASE=${ATHENA_DATABASE:-datalake_raw}
      - ATHENA_OUTPUT_LOCATION=${ATHENA_OUTPUT_LOCATION}
      - ATHENA_WORKGROUP=${ATHENA_WORKGROUP:-primary}
      # API Configuration
      - API_HOST=${API_HOST:-0.0.0.0}
      - API_PORT=${API_PORT:-8000}
      - API_RELOAD=${API_RELOAD:-false}
      # Logging
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
    restart: unless-stopped